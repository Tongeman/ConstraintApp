<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Constraint Quiz</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 32px;
            margin-bottom: 20px;
        }
        
        .intro {
            padding: 40px;
            line-height: 1.8;
            color: #333;
        }
        
        .intro p {
            margin-bottom: 20px;
        }
        
        .intro ul {
            list-style: none;
            margin: 20px 0;
        }
        
        .intro li {
            padding: 8px 0;
            padding-left: 30px;
            position: relative;
        }
        
        .intro li:before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: #667eea;
            font-weight: bold;
            font-size: 18px;
        }
        
        .content {
            padding: 40px;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 30px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s ease;
            width: 0%;
        }
        
        .progress-text {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }
        
        .question-container {
            display: none;
            animation: fadeIn 0.4s;
        }
        
        .question-container.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .question-title {
            font-size: 22px;
            font-weight: 600;
            color: #333;
            margin-bottom: 30px;
            line-height: 1.4;
        }
        
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .radio-option {
            display: flex;
            align-items: flex-start;
            padding: 18px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
        }
        
        .radio-option:hover {
            border-color: #667eea;
            background: #f8f9ff;
            transform: translateX(5px);
        }
        
        .radio-option input[type="radio"] {
            margin-right: 15px;
            margin-top: 4px;
            cursor: pointer;
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }
        
        .radio-option.selected {
            border-color: #667eea;
            background: #f8f9ff;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }
        
        .option-text {
            flex: 1;
            line-height: 1.6;
            color: #555;
        }
        
        .option-number {
            font-weight: 600;
            color: #667eea;
            margin-right: 8px;
        }
        
        .btn-container {
            display: flex;
            gap: 15px;
            margin-top: 40px;
        }
        
        .btn {
            flex: 1;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        
        .btn-secondary:hover:not(:disabled) {
            box-shadow: 0 10px 20px rgba(108, 117, 125, 0.3);
        }
        
        .hidden {
            display: none;
        }
        
        .email-form {
            max-width: 500px;
            margin: 0 auto;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .results {
            animation: fadeIn 0.5s;
        }
        
        .results h2 {
            color: #667eea;
            font-size: 28px;
            margin-bottom: 20px;
        }
        
        .results h3 {
            color: #667eea;
            font-size: 22px;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        
        .constraint-highlight {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .constraint-highlight h3 {
            color: #856404;
            margin-top: 0;
        }
        
        .score-summary {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .score-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .score-item:last-child {
            border-bottom: none;
        }
        
        .score-label {
            color: #555;
        }
        
        .score-value {
            font-weight: 600;
            color: #667eea;
        }
        
        .recommendations {
            line-height: 1.8;
            color: #555;
        }
        
        .recommendations p {
            margin-bottom: 15px;
        }
    </style>
	<script src="quiz-data.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Find Your Business Growth Constraint</h1>
        </div>
        
        <!-- Introduction Screen -->
        <div id="introScreen" class="intro">
            <p>Every business typically has a single constraint limiting its growth. If you want to scale, you have to find and resolve that constraint.</p>
            
            <p>Most CEOs waste resources improving areas that don't actually matter while the real bottleneck quietly chokes their progress. This quick quiz will help you identify exactly where your growth is stuck, so you can focus your efforts where they'll actually make a difference.</p>
            
            <ul>
                <li>Takes less than 5 minutes to complete</li>
                <li>Get instant, actionable insights specific to your business</li>
                <li>Identify your #1 constraint with precision</li>
                <li>Discover exactly where to focus for maximum growth impact</li>
            </ul>
            
            <button class="btn" onclick="startQuiz()" style="margin-top: 30px; width: 100%;">Start the Quiz</button>
        </div>
        
        <!-- Quiz Questions -->
        <div id="quizScreen" class="content hidden">
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
            <div class="progress-text" id="progressText">Question 1 of 9</div>
            
            <div id="questionsContainer"></div>
            
            <div class="btn-container">
                <button class="btn btn-secondary" id="prevBtn" onclick="previousQuestion()" disabled>Previous</button>
                <button class="btn" id="nextBtn" onclick="nextQuestion()" disabled>Next</button>
            </div>
        </div>
        
        <!-- Email Capture -->
        <div id="emailScreen" class="content hidden">
            <div class="email-form">
                <h2 style="text-align: center; color: #667eea; margin-bottom: 20px;">Almost There!</h2>
                <p style="text-align: center; margin-bottom: 30px; color: #555;">Enter your details to see your personalized results</p>
                
                <form id="emailForm" onsubmit="submitEmail(event)">
                      <div class="form-group">
                           <label for="userName">Name</label>
                           <input type="text" id="userName" required>
                      </div>
    
                      <div class="form-group">
                             <label for="userEmail">Email</label>
                             <input type="email" id="userEmail" required>
                      </div>
    
                      <div class="form-group" style="display: flex; align-items: start; gap: 10px;">
                             <input type="checkbox" id="emailConsent" required style="margin-top: 4px; width: auto; flex-shrink: 0;">
                             <label for="emailConsent" style="margin: 0; font-weight: normal; line-height: 1.5;">
                                    I agree to receive my quiz results and helpful emails about growing my business. You can unsubscribe at any time.
                             </label>
                      </div>
    
                      <button type="submit" class="btn" style="width: 100%;">View My Results</button>
                 </form>
            </div>
        </div>
        
        <!-- Results Screen -->
        <div id="resultsScreen" class="content hidden">
            <div class="results">
                <h2>Your Business Constraint Analysis</h2>
                
                <div class="constraint-highlight">
                    <h3 id="primaryConstraint"></h3>
                    <p id="constraintDescription"></p>
                </div>
                
                <h3>Your Scores</h3>
                <div class="score-summary" id="scoresSummary"></div>
                
                <h3>Recommendations</h3>
                <div class="recommendations" id="recommendationsText"></div>
                
                <button class="btn" onclick="resetQuiz()" style="margin-top: 30px; width: 100%;">Take Quiz Again</button>
            </div>
        </div>
    </div>
    
    <script>
        // Quiz data
        const questions = quizConfig.questions;
        
        let currentQuestion = 0;
        let answers = {};
        let userData = {};
        
        function startQuiz() {
            document.getElementById('introScreen').classList.add('hidden');
            document.getElementById('quizScreen').classList.remove('hidden');
            renderQuestions();
            showQuestion(0);
        }
        
        function renderQuestions() {
            const container = document.getElementById('questionsContainer');
            
            questions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-container';
                questionDiv.id = `question-${index}`;
                
                let optionsHtml = '';
                q.options.forEach((option, optIndex) => {
                    optionsHtml += `
                        <label class="radio-option" data-question="${index}" data-value="${option.value}">
                            <input type="radio" name="q${index}" value="${option.value}" onchange="selectAnswer(${index}, ${option.value})">
                            <span class="option-text">
                                <span class="option-number">${option.value}.</span>
                                ${option.text}
                            </span>
                        </label>
                    `;
                });
                
                questionDiv.innerHTML = `
                    <div class="question-title">${q.title}</div>
                    <div class="radio-group">
                        ${optionsHtml}
                    </div>
                `;
                
                container.appendChild(questionDiv);
            });
        }
        
        function showQuestion(index) {
            document.querySelectorAll('.question-container').forEach(q => q.classList.remove('active'));
            document.getElementById(`question-${index}`).classList.add('active');
            
            currentQuestion = index;
            updateProgress();
            updateButtons();
        }
        
        function selectAnswer(questionIndex, value) {
            answers[questions[questionIndex].id] = value;
            
            // Update visual selection
            document.querySelectorAll(`[data-question="${questionIndex}"]`).forEach(option => {
                option.classList.remove('selected');
            });
            document.querySelector(`[data-question="${questionIndex}"][data-value="${value}"]`).classList.add('selected');
            
            updateButtons();
        }
        
        function updateProgress() {
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = `Question ${currentQuestion + 1} of ${questions.length}`;
        }
        
        function updateButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.disabled = currentQuestion === 0;
            
            const currentAnswered = answers[questions[currentQuestion].id] !== undefined;
            nextBtn.disabled = !currentAnswered;
            
            if (currentQuestion === questions.length - 1 && currentAnswered) {
                nextBtn.textContent = 'Complete';
            } else {
                nextBtn.textContent = 'Next';
            }
        }
        
        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                showQuestion(currentQuestion + 1);
            } else {
                // Quiz complete, show email form
                document.getElementById('quizScreen').classList.add('hidden');
                document.getElementById('emailScreen').classList.remove('hidden');
            }
        }
        
        function previousQuestion() {
            if (currentQuestion > 0) {
                showQuestion(currentQuestion - 1);
            }
        }
        
        async function submitEmail(event) {
            event.preventDefault();
            
            userData.name = document.getElementById('userName').value;
            userData.email = document.getElementById('userEmail').value;
			userData.emailConsent = document.getElementById('emailConsent').checked;
            
            // Disable submit button while processing
            const submitBtn = event.target.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Saving...';
            
            try {
                // Send data to Netlify function
                const response = await fetch('/.netlify/functions/submit-quiz', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        name: userData.name,
                        email: userData.email,
						emailConsent: userData.emailConsent,
                        answers: answers
                    })
                });
                
                const result = await response.json();
                
                if (!response.ok) {
                    throw new Error(result.error || 'Failed to submit quiz');
                }
                
                console.log('Quiz saved successfully:', result);
                
                // Show results
                calculateResults();
                document.getElementById('emailScreen').classList.add('hidden');
                document.getElementById('resultsScreen').classList.remove('hidden');
                
            } catch (error) {
                console.error('Error submitting quiz:', error);
                alert('There was an error saving your results. Please try again.');
                submitBtn.disabled = false;
                submitBtn.textContent = 'View My Results';
            }
        }
        
        function calculateResults() {
            // Find the lowest score (primary constraint)
            let lowestScore = 5;
            let primaryConstraintId = null;
            
            // Check each answer in order (for tie-breaking)
            questions.forEach(q => {
                const score = answers[q.id];
                if (score < lowestScore) {
                    lowestScore = score;
                    primaryConstraintId = q.id;
                }
            });
            
            const primaryConstraint = questions.find(q => q.id === primaryConstraintId);
            
            // Display primary constraint
            document.getElementById('primaryConstraint').textContent = `Your Primary Constraint: ${primaryConstraint.category}`;
            document.getElementById('constraintDescription').textContent = `Based on your responses, ${primaryConstraint.category.toLowerCase()} is the biggest bottleneck limiting your business growth right now.`;
            
            // Display all scores
            let scoresHtml = '';
            questions.forEach(q => {
                const score = answers[q.id];
                scoresHtml += `
                    <div class="score-item">
                        <span class="score-label">${q.category}</span>
                        <span class="score-value">${score}/5</span>
                    </div>
                `;
            });
            document.getElementById('scoresSummary').innerHTML = scoresHtml;
            
            // Generate recommendations based on constraint
            const recommendations = getRecommendations(primaryConstraintId, lowestScore);
            document.getElementById('recommendationsText').innerHTML = recommendations;
        }
        
        function getRecommendations(constraintId, score) {
    // Get recommendation from quiz-data.js
    const rec = quizConfig.recommendations[constraintId];
    
    if (!rec) {
        return '<p>Focus on improving this area to unlock your business growth.</p>';
    }
    
    return `
        <p><strong>${rec.description}</strong></p>
        <p><strong>Quick wins:</strong> ${rec.quickWins}</p>
        <p><strong>Next level:</strong> ${rec.nextLevel}</p>
    `;
}
        
        function resetQuiz() {
            currentQuestion = 0;
            answers = {};
            userData = {};
            
            // Reset all radio buttons
            document.querySelectorAll('input[type="radio"]').forEach(radio => {
                radio.checked = false;
            });
            
            // Reset visual selections
            document.querySelectorAll('.radio-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Reset form
            document.getElementById('emailForm').reset();
            
            // Show intro screen
            document.getElementById('resultsScreen').classList.add('hidden');
            document.getElementById('introScreen').classList.remove('hidden');
        }
    </script>
</body>
</html>
            